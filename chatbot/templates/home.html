{% extends 'base.html' %} {% load jd_format %} {% block content %}
<div class="container mt-4">
  <div class="row">
    <!-- left form -->
    <div class="col-md-5">
      <h3 class="mb-4">AI Job Description Generator</h3>

      <form method="post">
        {% csrf_token %}

        <p class="text-muted">
          Fields marked with <span class="text-danger">*</span> are required.
        </p>

        <!-- Company Name (required) -->
        <div class="mb-3">
          <label class="form-label">
            Company Name <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            name="company_name"
            placeholder="e.g. Acme Corp"
            value="{{ company_name|default:'' }}"
            required
          />
        </div>

        <!-- Job Title (required) -->
        <div class="mb-3">
          <label class="form-label">
            Job Title <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            name="job_title"
            placeholder="e.g. Data Engineer"
            value="{{ job_title|default:'' }}"
            required
          />
        </div>

        <!-- Tech Skills (required) -->
        <div class="mb-3">
          <label class="form-label">
            Tech Skills <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            name="tech_skills"
            placeholder="e.g. Python, AWS, Spark, ETL"
            value="{{ tech_skills|default:'' }}"
            required
          />
          <small class="text-muted">Comma separated skills.</small>
        </div>

        <!-- Experience Level (required) -->
        <div class="mb-3">
          <label class="form-label">
            Experience Level <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            name="experience_level"
            placeholder="e.g. 3â€“5 years"
            value="{{ experience_level|default:'' }}"
            required
          />
        </div>

        <!-- Location (required) -->
        <div class="mb-3">
          <label class="form-label">
            Location <span class="text-danger">*</span>
          </label>
          <input
            type="text"
            class="form-control"
            name="location"
            placeholder="e.g. San Francisco / Remote"
            value="{{ location|default:'' }}"
            required
          />
        </div>

        <!-- Optional notes (the only non-required field) -->
        <div class="mb-3">
          <label class="form-label">Optional</label>
          <input
            type="text"
            class="form-control"
            name="company_tone"
            placeholder="Any extra notes or preferences (optional)"
            value="{{ company_tone|default:'' }}"
          />
        </div>

        <button type="submit" class="btn btn-primary w-100">
          Generate Job Description
        </button>
      </form>
    </div>

    <!-- right preview -->
    <div class="col-md-7">
      <h4 class="mb-3">Preview</h4>
      <div class="card" style="min-height: 300px">
        <div class="card-body" id="jd-content">
          {% if not job_description %}
          <span class="text-muted">
            Fill in the form on the left and click
            <strong>"Generate Job Description"</strong> to see the result here.
          </span>
          {% else %} {{ job_description_html|safe }} {% endif %}
        </div>
      </div>

      {% if job_description %}
      <div class="mt-3 d-flex gap-2">
        <button
          class="btn btn-outline-secondary me-2"
          type="button"
          onclick="copyJD()"
        >
          Copy JD
        </button>
        <a href="{% url 'past' %}" class="btn btn-success"> View History </a>
      </div>
      {% endif %}
    </div>
  </div>
</div>

<script>
  function copyJD() {
    const text = document.getElementById("jd-content").innerText;
    navigator.clipboard.writeText(text).then(function () {
      alert("Job description copied to clipboard!");
    });
  }
</script>
{% endblock %}
